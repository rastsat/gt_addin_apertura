{"version":3,"sources":["openBoxPulse.js"],"names":["geotab","customButtons","openBoxPulse","event","api","state","preventDefault","deviceId","call","typeName","entity","device","id","messageContent","isRelayOn","contentType","isDirectionToVehicle","console","log","element","errorHandler","setTimeout","search","testMessages","delivered","alert","appendAndPoll","divId","textMessageId","Date","now","message"],"mappings":";;AAAA;AACA;;;;;;;AAOAA,OAAOC,aAAP,CAAqBC,YAArB,GAAoC,UAACC,KAAD,EAAQC,GAAR,EAAaC,KAAb,EAAuB;AACzD;;AAEAF,UAAMG,cAAN;AACA;;;;AAIA;;;;AAIA,QAAIC,WAAS,IAAb;;AAEAH,QAAII,IAAJ,CAAS,KAAT,EAAgB;AACdC,kBAAU,aADI;AAEdC,gBAAQ;AACJC,oBAAQ;AACJC,oBAAIL;AADA,aADJ;AAIJM,4BAAgB;AACZC,2BAAW,IADC;AAEZC,6BAAa;AAFD,aAJZ;AAQJC,kCAAsB;AARlB;AAFM,KAAhB,EAYC,mBAAS;AAACC,gBAAQC,GAAR,CAAY,wBAAsBC,OAAlC;AAA2C,KAZtD,EAYwDC,YAZxD;;AAcFC,eAAW,YAAM;AACfjB,YAAII,IAAJ,CAAS,KAAT,EAAgB;AACZC,sBAAU,aADE;AAEZa,oBAAQ;AACJV,oBAAIL;AADA;AAFI,SAAhB,EAKG,wBAAgB;AACf,gBAAIgB,aAAa,CAAb,EAAgBC,SAApB,EAA+B;AAC7BpB,oBAAII,IAAJ,CAAS,KAAT,EAAgB;AACdC,8BAAU,aADI;AAEdC,4BAAQ;AACJC,gCAAQ;AACJC,gCAAIL;AADA,yBADJ;AAIJM,wCAAgB;AACZC,uCAAW,KADC,EACK;AACjBC,yCAAa;AAFD,yBAJZ;AAQJC,8CAAsB;AARlB;AAFM,iBAAhB,EAYC,mBAAS;AACRC,4BAAQC,GAAR,CAAY,wBAAsBC,OAAlC;AACAM,0BAAM,+BAAN;AACH,iBAfC,EAgBEL,YAhBF;AAiBD,aAlBD,MAkBO;AACHH,wBAAQC,GAAR,CAAY,YAAZ;AACH;AACJ,SA3BD,EA2BGE,YA3BH;AA4BD,KA7BD,EA6BG,CA7BH;;AA+BA,QAAIM,gBAAgB,SAAhBA,aAAgB,gBAAiB;AACnC,YAAIC,QAAQC,gBAAgB,GAAhB,GAAsBC,KAAKC,GAAL,EAAtB,GAAiC,QAAjC,GAA4C,IAAID,IAAJ,EAAxD;AACAZ,gBAAQC,GAAR,CAAYS,KAAZ;AACD,KAHD;;AAKA,QAAIP,eAAe,SAAfA,YAAe,UAAW;AAC5BH,gBAAQC,GAAR,CAAYa,OAAZ;AACD,KAFD;AAIC,CApED","file":"openBoxPulse.js","sourcesContent":["/* eslint-disable no-alert */\r\n/**\r\n * The function is called whenever the Add-In button is clicked.\r\n *\r\n * @param {object} event - The event dispatched from the button click.\r\n * @param {object} api - The GeotabApi object for making calls to MyGeotab.\r\n * @param {object} state - The page state object allows access to URL, page navigation and global group filter.\r\n */\r\ngeotab.customButtons.openBoxPulse = (event, api, state) => {\r\n  'use strict';\r\n\r\n  event.preventDefault();\r\n  /*state.setState({\r\n    hello: 'world'\r\n  });*/\r\n\r\n  /*let deviceId = (() => {\r\n    let pageState = state.getState();\r\n    return (pageState && pageState.id && pageState.id.length) ? pageState.id : null;\r\n  })();*/\r\n  let deviceId='b1';\r\n\r\n  api.call('Add', {\r\n    typeName: 'TextMessage',\r\n    entity: {\r\n        device: {\r\n            id: deviceId\r\n        },\r\n        messageContent: {\r\n            isRelayOn: true,\r\n            contentType: 'IoxOutput'\r\n        },\r\n        isDirectionToVehicle: true\r\n    }\r\n}, element=>{console.log('elemento apertura: '+element)}, errorHandler);\r\n\r\nsetTimeout(() => {\r\n  api.call('Get', {\r\n      typeName: 'TextMessage',\r\n      search: {\r\n          id: deviceId\r\n      }\r\n  }, testMessages => {\r\n      if (testMessages[0].delivered) {\r\n        api.call('Add', {\r\n          typeName: 'TextMessage',\r\n          entity: {\r\n              device: {\r\n                  id: deviceId\r\n              },\r\n              messageContent: {\r\n                  isRelayOn: false,///state === 'On',\r\n                  contentType: 'IoxOutput'\r\n              },\r\n              isDirectionToVehicle: true\r\n          }\r\n      }, element=>{\r\n          console.log('elemento de cierre:'+element)\r\n          alert('Apertura enviada exitosamente')\r\n      },\r\n          errorHandler);\r\n      } else {\r\n          console.log('no enviado')\r\n      }\r\n  }, errorHandler);\r\n}, 1);\r\n\r\nlet appendAndPoll = textMessageId => {\r\n  let divId = textMessageId + '-' + Date.now()+'Sent: ' + new Date();\r\n  console.log(divId)\r\n};\r\n\r\nlet errorHandler = message => {\r\n  console.log(message)\r\n};\r\n  \r\n}\r\n\r\n"]}